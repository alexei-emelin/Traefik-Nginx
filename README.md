## Задача: развернуть web-сервер с двумя сайтами, работающими по протоколу HTTPS.

Запросы, пришедшие по протоколу HTTP, должны перенаправляться на HTTPS.

Контент сайтов - следующий текст:

```Welcome to site 1``` и ```Welcome to site 2``` для первого и второго сайта соответственно.

В качестве web-серверов для сайтов мы будем использовать Nginx в docker контейнере (каждый сайт в своем контейнере).
В качество обратного прокси с терминированием SSL задействуем Traefik (https://docs.traefik.io/) в контейнере. Именно он будет слушать порты 80 и 443 ВМ. SSL сертификаты Traefik самостоятельно получит в центре сертификации Let's Encrypt.
Мы будем использовать официальные образы от Traefik и Nginx.
Для оркестрации этих трех контейнеров мы будем использовать Docker Compose (https://docs.docker.com/compose/). 
Docker Compose позволит организовать старт и остановку всех трех контейнеров одной командой.
Docker и Docker Compose необходимо установить на сервер самостоятельно.

Поднимаем виртуальную машину с ОС Ubuntu, я использовал Yandex Cloud.
Клонируем в нее папку Traefik_Nginx из репозитория, которая содержит:
1. Файл конфигурации оркестратора: ```docker-compose.yml```
2. Файл конфигурации Traefik (лежит в отдельной папке traefik_config): ```traefik.yml```
3. Страничка для первого сайта с текстом (в отдельной папке site_1): ```index.html```
4. Страничка для второго сайта с текстом (в отдельной папке site_2): ```index.html```

Создаем файл letsencrypt\acme.json, где будут храниться сертификаты, заполним его пустым объектом json и раздадим на него права (при удалении контейнеров, нам не придется генерировать новые сертификаты):
```bash
touch letsencrypt/acme.json
echo "{}" > letsencrypt/acme.json
chmod 600 letsencrypt/acme.json
```

Создадим сеть для наших контейнеров:

```bash
docker network create traefik-network
```

Для запуска контейнеров переходим в папку (Traefik_Nginx) с файлом ```docker-compose.yml``` и запускаем сборку:
```bash
sudo docker-compose -f docker-compose.yml up
```

Для добавления еще одного сайта нам потребуется создать еще одну папку с index.html файлом (минимальным контетом сайта)
И изменить файл ```docker-compose.yml```

Скопируем блок с site1, заменим значение Host (DNS адрес сайта) и заменим монтируемую папку с ```index.html```

В скопированном блоке записи "site1" заменим на "site2"

Зададим другие произвольные порты для 80 и 443 нашего контейнера.

P.S. можно удалить проброс портов для nginx из docker-compose, traefik по DNS имени распределит запросы.

Я добавил их, чтобы проверить работоспособность сайта с пк из внешней сети, до включения traefik.